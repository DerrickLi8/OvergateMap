<!DOCTYPE html>
<html>
   <head>
      <title>OvergateMap</title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <!-- Import Bootstrap -->
      <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
 
      <!--[if lt IE 9]>
         <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
         <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
      <![endif]-->
	   
	<script src="https://cdn-webgl.wrld3d.com/wrldjs/dist/latest/wrld.js"></script>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.0.1/leaflet.css" rel="stylesheet" />  
	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	  <script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
	<script src="plotly-latest.min.js"></script>
	<style>
	 body {
			height: 100%;
            font-family: Arial;
			font-size: 40pt;
			color: black;
        }

	</style> 
	<style>
	
	.greg{
		color: white;
		-webkit-transition: all 1s ease-in-out;
		transition: all 1s ease-in-out;
	}
	</style>
   </head>
   <body onload="changeTextColour();">
		
		
	<!-- Tabs at top of the window -->
	<ul class="nav nav-tabs  nav-justified">
      <li class="active"><a data-toggle="tab" href="#stats">Stats</a></li>
      <li ><a data-toggle="tab" href="#vis">Visualisation</a></li>
      </ul>
      
	  <!-- Stats -->
      <div class="tab-content">
      <div id="stats" class="tab-pane fade in active">
		<div class="container" >
		<div class = "alert alert-info">
		<p class="greg"> <span class="glyphicon glyphicon-chevron-right"></span> Current Visitors: </p>
		<p class="greg"> <span class="glyphicon glyphicon-chevron-right"></span> Population Density: </p>  
		<p class="greg"> <span class="glyphicon glyphicon-chevron-right"></span> Density Rating: </p>  
		<p class="greg"> <span class="glyphicon glyphicon-chevron-right"></span> Total Visitors: </p>  
		</div>
		</div>
	  </div>
		
		
	  <!-- Visualisation -->
      <div id="vis" class="tab-pane fade">
		 <div id="graph" ></div>
		 <script>
		

		var d3 = Plotly.d3;
		var WIDTH_IN_PERCENT_OF_PARENT = 100,
    	HEIGHT_IN_PERCENT_OF_PARENT = 100;

		var gd3 = d3.select("div[id='graph']")
  		.style({
    		width: WIDTH_IN_PERCENT_OF_PARENT + '%',
    		'margin-left': (100 - WIDTH_IN_PERCENT_OF_PARENT) / 2 + '%',
    		height: HEIGHT_IN_PERCENT_OF_PARENT + 'vh',
    		'margin-top': (100 - HEIGHT_IN_PERCENT_OF_PARENT) / 2 + 'vh'
			});

		var time = new Date();

		var graph = gd3.node();
		
		var data = [{
		  x: [time], 
		  y: [getNum()+3],
		  fill: 'tozeroy',
		  mode: 'lines',
		  line: {color: '#80CAF6'}
		  
		}]
		
		var layout = {
		  font: {size: 16},
		  autosize: true,
		  
		  margin: {
			l: 50,
			r: 50,
			b: 100,
			t: 0,
			pad: 4
		  },

		};

		Plotly.plot('graph', data, layout, {title: 'Live Population',font:{ size:16 }});  
		

		var cnt = 0;

		var interval = setInterval(function() {
		  
		  
		  var time = new Date();
		  
		  var update = {
		  x:  [[time]],
		  y: [[getNum()]]
		  }
		  
		  var olderTime = time.setMinutes(time.getMinutes() - 1);
		  var futureTime = time.setMinutes(time.getMinutes() + 1);
		  
		  var minuteView = {
				xaxis: {
				  type: 'date',
				  range: [olderTime,futureTime]
				}
			  };
		  
		  Plotly.relayout('graph', minuteView,);
		  Plotly.extendTraces('graph', update, [0]);
		  window.onresize = function() { Plotly.Plots.resize( graph ) };

		  if(cnt === 100) clearInterval(interval);
		}, 1000);

		 </script>
      </div>
	  </div>
	  
   </body>
   <script>
	   function changeTextColour(){
		var bitsOfText = document.getElementsByClassName('greg');
		for (x=0; x<bitsOfText.length; x++){
			bitsOfText[x].style.color = 'black';
		}
	   }
   </script>
</html>











